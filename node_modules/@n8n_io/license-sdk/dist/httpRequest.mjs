import{fetch as a,getGlobalDispatcher as h,setGlobalDispatcher as y,Dispatcher as g,ProxyAgent as u}from"undici";import{URL as x}from"node:url";var i="2.19.0";function n(t){let r=process.env[t];return r?new u(r):null}var p=n("http_proxy_license_server")||n("http_proxy"),c=n("https_proxy_license_server")||n("https_proxy"),f={...p?{"http:":p}:{},...c?{"https:":c}:{}},d=(process.env.no_proxy??"").split(",").map(t=>t.trim()),l=h();y(new class extends g{dispatch(t,r){if(t.origin){let{host:o,protocol:e}=typeof t.origin=="string"?new x(t.origin):t.origin;if(!d.some(s=>s.startsWith(".")?o.endsWith(s):o===s)){let s=f[e];s&&s.dispatch(t,r)}}return l.dispatch(t,r)}});async function m(t,r,o={}){try{let e=await a(t,{method:"post",body:JSON.stringify(r),headers:{"Content-Type":"application/json","User-Agent":`License-SDK/${i} (Node.js ${process.version}; ${process.platform}) ${o.productIdentifier}`},signal:AbortSignal.timeout(o.timeoutInMs??3e4)}),s=await e.json();return{status:e.status,data:s}}catch(e){throw new Error("Connection Error",{cause:e})}}var S={postRequest:m};export{S as default,m as postRequest};
//# sourceMappingURL=httpRequest.mjs.map